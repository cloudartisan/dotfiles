#!/bin/bash

# Exit on error
set -e

echo "==> Installing Homebrew packages"

# Check if Homebrew is installed
if ! command -v brew &> /dev/null; then
  echo "Installing Homebrew..."
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

# Install packages from Brewfile
brew bundle --file="$HOME/Brewfile"

echo "==> Installing Cursor Agent CLI"

# Check if cursor-agent is already installed
if command -v cursor-agent >/dev/null 2>&1; then
  echo "cursor-agent is already installed"
else
  # Install cursor-agent using the official installer
  curl https://cursor.com/install -fsS | bash
  
  # Verify installation
  if [ -x "$HOME/.local/bin/cursor-agent" ]; then
    echo "✓ cursor-agent installed successfully"
  else
    echo "✗ cursor-agent installation failed"
  fi
fi

echo "✓ All packages installed"
